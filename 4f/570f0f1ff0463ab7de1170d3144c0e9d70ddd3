Supersedes: https://gitlab.freedesktop.org/NetworkManager/NetworkManager/-/merge_requests/677
https://gitlab.freedesktop.org/NetworkManager/NetworkManager/-/merge_requests/1133
